NOTES

Here's the query to make the spreadsheet.  Note that for the joins, the only
value that varies accross rows for the same dataset is tissue type.  Also
note that since the description and date_created fields were empty, I left
them out.

select
'db_id','Internal Name','Species','Disease','Tissue/Tumor','Posting Restriction','Institution','Investigator','Number of Samples','name','abstract_file_path','citation_file_path','user_agreement_file_path','readme_file_path','Type','Status'
union
select
DP.id,name,species_name,disease_name,tissue_name,posting_restriction_name,institution,principal_investigator,approximate_num_individuals,display_name,abstract_file_path,citation_file_path,user_agreement_file_path,readme_file_path,type_name,class_name
INTO OUTFILE '/var/tmp/TheDatasets2.csv'
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY '\n'
from datapacket as DP join dataset as DS on DP.id = DS.datapacket_id;

~/platform/deflaux/scripts/DatasetLoader>cut -d "," -f "1-4,6-" TheDatasets2.csv  | uniq | wc -l
     115

mysql> select distinct(description) from dataset;
+-------------+
| description |
+-------------+
| NULL        |
+-------------+
1 row in set (0.01 sec)

mysql> select distinct(date_created) from datapacket;
+--------------+
| date_created |
+--------------+
| NULL         |
+--------------+
1 row in set (0.00 sec)


mysql> desc datapacket     ;
+--------------------------+---------------+------+-----+---------+----------------+
| Field                    | Type          | Null | Key | Default | Extra          |
+--------------------------+---------------+------+-----+---------+----------------+
| id                       | smallint(6)   | NO   | PRI | NULL    | auto_increment |
| display_name             | varchar(128)  | NO   |     | NULL    |                |
| abstract_file_path       | varchar(1024) | NO   |     | NULL    |                |
| citation_file_path       | varchar(1024) | NO   |     | NULL    |                |
| user_agreement_file_path | varchar(1024) | NO   |     | NULL    |                |
| readme_file_path         | varchar(1024) | NO   |     | NULL    |                |
| type_name                | varchar(128)  | NO   | MUL | NULL    |                |
| class_name               | varchar(128)  | NO   | MUL | NULL    |                |
| num_likes                | smallint(6)   | NO   |     | NULL    |                |
| date_created             | date          | YES  |     | NULL    |                |
+--------------------------+---------------+------+-----+---------+----------------+
10 rows in set (0.01 sec)

mysql> desc data_type2datapacket;
+----------------+--------------+------+-----+---------+-------+
| Field          | Type         | Null | Key | Default | Extra |
+----------------+--------------+------+-----+---------+-------+
| datapacket_id  | smallint(6)  | NO   | PRI | 0       |       |
| data_type_name | varchar(128) | NO   | PRI |         |       |
+----------------+--------------+------+-----+---------+-------+
2 rows in set (0.01 sec)

mysql> select * from data_type2datapacket;
+---------------+----------------+
| datapacket_id | data_type_name |
+---------------+----------------+
|             1 | genotype       |
|             1 | intermediate   |
|             1 | phenotype      |

mysql> desc dataset;
+-----------------------------+---------------+------+-----+---------+----------------+
| Field                       | Type          | Null | Key | Default | Extra          |
+-----------------------------+---------------+------+-----+---------+----------------+
| id                          | smallint(6)   | NO   | PRI | NULL    | auto_increment |
| datapacket_id               | int(11)       | NO   |     | NULL    |                |
| name                        | varchar(128)  | NO   |     | NULL    |                |
| description                 | varchar(1024) | YES  |     | NULL    |                |
| species_name                | varchar(128)  | NO   | MUL | NULL    |                |
| disease_name                | varchar(128)  | NO   | MUL | NULL    |                |
| tissue_name                 | varchar(128)  | NO   | MUL | NULL    |                |
| posting_restriction_name    | varchar(128)  | NO   |     | NULL    |                |
| institution                 | varchar(128)  | YES  |     | NULL    |                |
| principal_investigator      | varchar(128)  | YES  |     | NULL    |                |
| approximate_num_individuals | int(11)       | YES  |     | NULL    |                |
+-----------------------------+---------------+------+-----+---------+----------------+

mysql> desc file;
+---------------------+---------------+------+-----+---------+----------------+
| Field               | Type          | Null | Key | Default | Extra          |
+---------------------+---------------+------+-----+---------+----------------+
| id                  | smallint(6)   | NO   | PRI | NULL    | auto_increment |
| datapacket_id       | smallint(6)   | NO   | MUL | NULL    |                |
| display_name        | varchar(128)  | NO   |     | NULL    |                |
| display_description | varchar(128)  | NO   |     | NULL    |                |
| full_path           | varchar(1024) | NO   |     | NULL    |                |
+---------------------+---------------+------+-----+---------+----------------+

SELECT * INTO OUTFILE '/var/tmp/TheSamples.csv'
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY '\n'
FROM dataset;

SELECT * INTO OUTFILE '/var/tmp/DownloadFiles.csv'
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY '\n'
FROM file;

SELECT * INTO OUTFILE '/var/tmp/TheDatasets.csv'
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY '\n'
FROM datapacket;

SELECT * INTO OUTFILE '/var/tmp/TheLayers.csv'
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY '\n'
FROM data_type2datapacket;



select DP.id,name,description,species_name,disease_name,tissue_name
,posting_restriction_name,institution,principal_investigator,approximate_num_individuals,
display_name, abstract_file_path, citation_file_path,
user_agreement_file_path, readme_file_path, type_name, class_name,
date_created from datapacket as DP join dataset as DS on DP.id = DS.datapacket_id;




